{"version":3,"sources":["../../../../src/features/classification/security-controls/utils.js"],"names":["React","getProp","isNil","FormattedCompMessage","Link","appRestrictionsMessageMap","downloadRestrictionsMessageMap","messages","ACCESS_POLICY_RESTRICTION","APP_RESTRICTION_MESSAGE_TYPE","DOWNLOAD_CONTROL","LIST_ACCESS_LEVEL","SHARED_LINK_ACCESS_LEVEL","SHARED_LINK","DOWNLOAD","EXTERNAL_COLLAB","APP","WATERMARK","DEFAULT","WITH_APP_LIST","WITH_OVERFLOWN_APP_LIST","DESKTOP","MOBILE","WEB","BLOCK","WHITELIST","BLACKLIST","COLLAB_ONLY","COLLAB_AND_COMPANY_ONLY","PUBLIC","getShortSecurityControlsMessage","controls","items","sharedLink","download","externalCollab","app","watermark","sharing","accessLevel","push","message","shortAllRestrictions","shortSharingDownload","shortSharingApp","shortDownloadApp","shortSharing","shortDownload","shortApp","shortWatermarking","getSharedLinkMessages","sharingCollabOnly","sharingCollabAndCompanyOnly","getWatermarkingMessages","isWatermarkEnabled","formattedCompMessage","getExternalCollabMessages","externalCollabBlock","externalCollabDomainList","getAppDownloadMessages","maxAppCount","appDownloadRestricted","apps","length","appsToDisplay","slice","remainingAppCount","appNames","map","displayText","join","appsList","values","tooltipMessage","allAppNames","messageType","getDownloadMessages","web","mobile","desktop","downloadRestrictions","platform","restrictions","Object","keys","forEach","platformKey","restrictExternalUsers","restrictManagedUsers","externalRestricted","externalAllowed","default","getFullSecurityControlsMessages"],"mappings":"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","sourcesContent":["// @flow\nimport * as React from 'react';\nimport getProp from 'lodash/get';\nimport isNil from 'lodash/isNil';\n\nimport type { Controls, MessageItem } from '../flowTypes';\n\nimport FormattedCompMessage from '../../../components/i18n/FormattedCompMessage';\nimport Link from '../../../components/link/Link';\nimport appRestrictionsMessageMap from './appRestrictionsMessageMap';\nimport downloadRestrictionsMessageMap from './downloadRestrictionsMessageMap';\nimport messages from './messages';\nimport {\n    ACCESS_POLICY_RESTRICTION,\n    APP_RESTRICTION_MESSAGE_TYPE,\n    DOWNLOAD_CONTROL,\n    LIST_ACCESS_LEVEL,\n    SHARED_LINK_ACCESS_LEVEL,\n} from '../constants';\n\nconst { SHARED_LINK, DOWNLOAD, EXTERNAL_COLLAB, APP, WATERMARK } = ACCESS_POLICY_RESTRICTION;\nconst { DEFAULT, WITH_APP_LIST, WITH_OVERFLOWN_APP_LIST } = APP_RESTRICTION_MESSAGE_TYPE;\nconst { DESKTOP, MOBILE, WEB } = DOWNLOAD_CONTROL;\nconst { BLOCK, WHITELIST, BLACKLIST } = LIST_ACCESS_LEVEL;\nconst { COLLAB_ONLY, COLLAB_AND_COMPANY_ONLY, PUBLIC } = SHARED_LINK_ACCESS_LEVEL;\n\nconst getShortSecurityControlsMessage = (controls: Controls): Array<MessageItem> => {\n    const items = [];\n    const { sharedLink, download, externalCollab, app, watermark } = controls;\n\n    // Shared link and external collab restrictions are grouped\n    // together as generic \"sharing\" restrictions\n    const sharing = (sharedLink && sharedLink.accessLevel !== PUBLIC) || externalCollab;\n\n    if (sharing && download && app) {\n        items.push({ message: messages.shortAllRestrictions });\n    } else if (sharing && download) {\n        items.push({ message: messages.shortSharingDownload });\n    } else if (sharing && app) {\n        items.push({ message: messages.shortSharingApp });\n    } else if (download && app) {\n        items.push({ message: messages.shortDownloadApp });\n    } else if (sharing) {\n        items.push({ message: messages.shortSharing });\n    } else if (download) {\n        items.push({ message: messages.shortDownload });\n    } else if (app) {\n        items.push({ message: messages.shortApp });\n    }\n\n    if (watermark) {\n        items.push({ message: messages.shortWatermarking });\n    }\n\n    return items;\n};\n\nconst getSharedLinkMessages = (controls: Controls): Array<MessageItem> => {\n    const items = [];\n    const accessLevel = getProp(controls, `${SHARED_LINK}.accessLevel`);\n\n    switch (accessLevel) {\n        case COLLAB_ONLY:\n            items.push({ message: messages.sharingCollabOnly });\n            break;\n        case COLLAB_AND_COMPANY_ONLY:\n            items.push({ message: messages.sharingCollabAndCompanyOnly });\n            break;\n        default:\n            // no-op\n            break;\n    }\n    return items;\n};\n\nconst getWatermarkingMessages = (controls: Controls): Array<MessageItem> => {\n    const items = [];\n    const isWatermarkEnabled = getProp(controls, `${WATERMARK}.enabled`, false);\n    if (isWatermarkEnabled) {\n        const formattedCompMessage = (\n            <FormattedCompMessage\n                id=\"boxui.securityControls.watermarkingAppliedWithLink\"\n                description=\"Bullet point that summarizes watermarking applied to classification\"\n            >\n                Watermarking will be applied, click{' '}\n                <Link\n                    className=\"support-link\"\n                    href=\"https://support.box.com/hc/en-us/articles/360044195253\"\n                    target=\"_blank\"\n                >\n                    here\n                </Link>{' '}\n                more details on Watermarking\n            </FormattedCompMessage>\n        );\n        items.push({ message: formattedCompMessage });\n    }\n\n    return items;\n};\n\nconst getExternalCollabMessages = (controls: Controls): Array<MessageItem> => {\n    const items = [];\n    const accessLevel = getProp(controls, `${EXTERNAL_COLLAB}.accessLevel`);\n\n    switch (accessLevel) {\n        case BLOCK:\n            items.push({ message: messages.externalCollabBlock });\n            break;\n        case WHITELIST:\n        case BLACKLIST:\n            items.push({ message: messages.externalCollabDomainList });\n            break;\n        default:\n            // no-op\n            break;\n    }\n    return items;\n};\n\nconst getAppDownloadMessages = (controls: Controls, maxAppCount?: number): Array<MessageItem> => {\n    const items = [];\n    const accessLevel = getProp(controls, `${APP}.accessLevel`);\n\n    switch (accessLevel) {\n        case BLOCK:\n            items.push({ message: messages.appDownloadRestricted });\n            break;\n        case WHITELIST:\n        case BLACKLIST: {\n            const apps = getProp(controls, `${APP}.apps`, []);\n\n            maxAppCount = isNil(maxAppCount) ? apps.length : maxAppCount;\n            const appsToDisplay = apps.slice(0, maxAppCount);\n            const remainingAppCount = apps.slice(maxAppCount).length;\n            const appNames = appsToDisplay.map(({ displayText }) => displayText).join(', ');\n\n            if (remainingAppCount) {\n                const appsList = apps.map(({ displayText }) => displayText).join(', ');\n\n                items.push({\n                    message: {\n                        ...appRestrictionsMessageMap[accessLevel][WITH_OVERFLOWN_APP_LIST],\n                        values: { appNames, remainingAppCount },\n                    },\n                    tooltipMessage: {\n                        ...messages.allAppNames,\n                        values: { appsList },\n                    },\n                });\n            } else {\n                // Display list of apps if available, otherwise use generic\n                // app restriction copy\n                const messageType = apps.length ? WITH_APP_LIST : DEFAULT;\n\n                items.push({\n                    message: {\n                        ...appRestrictionsMessageMap[accessLevel][messageType],\n                        values: { appNames },\n                    },\n                });\n            }\n            break;\n        }\n        default:\n            // no-op\n            break;\n    }\n    return items;\n};\n\nconst getDownloadMessages = (controls: Controls): Array<MessageItem> => {\n    const items = [];\n    const { web, mobile, desktop } = getProp(controls, DOWNLOAD, {});\n\n    const downloadRestrictions = {\n        [WEB]: {\n            platform: WEB,\n            restrictions: web,\n        },\n        [MOBILE]: {\n            platform: MOBILE,\n            restrictions: mobile,\n        },\n        [DESKTOP]: {\n            platform: DESKTOP,\n            restrictions: desktop,\n        },\n    };\n\n    Object.keys(downloadRestrictions).forEach(platformKey => {\n        const { platform, restrictions } = downloadRestrictions[platformKey];\n\n        if (!restrictions) {\n            return;\n        }\n        const { restrictExternalUsers, restrictManagedUsers } = restrictions;\n\n        if (restrictManagedUsers && restrictExternalUsers) {\n            items.push({ message: downloadRestrictionsMessageMap[platform].externalRestricted[restrictManagedUsers] });\n        } else if (restrictManagedUsers) {\n            items.push({ message: downloadRestrictionsMessageMap[platform].externalAllowed[restrictManagedUsers] });\n        } else if (restrictExternalUsers) {\n            items.push({ message: downloadRestrictionsMessageMap[platform].externalRestricted.default });\n        }\n    });\n\n    return items;\n};\n\nconst getFullSecurityControlsMessages = (controls: Controls, maxAppCount?: number): Array<MessageItem> => {\n    const items = [\n        ...getSharedLinkMessages(controls),\n        ...getExternalCollabMessages(controls),\n        ...getDownloadMessages(controls),\n        ...getAppDownloadMessages(controls, maxAppCount),\n        ...getWatermarkingMessages(controls),\n    ];\n    return items;\n};\n\nexport { getShortSecurityControlsMessage, getFullSecurityControlsMessages };\n"],"file":"utils.js"}