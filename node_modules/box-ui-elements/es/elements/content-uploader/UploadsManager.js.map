{"version":3,"sources":["../../../src/elements/content-uploader/UploadsManager.js"],"names":["React","classNames","ItemList","OverallUploadsProgressBar","STATUS_ERROR","UploadsManager","isExpanded","isVisible","isResumableUploadsEnabled","isDragging","items","onItemActionClick","onRemoveActionClick","onUpgradeCTAClick","onUploadsManagerActionClick","toggleUploadsManager","view","handleProgressBarKeyDown","event","key","numFailedUploads","totalSize","totalUploaded","forEach","item","status","isFolder","size","progress","percent","isResumeVisible","hasMultipleFailedUploads"],"mappings":"AAAA;;;;AAKA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,UAAP,MAAuB,YAAvB;AACA,OAAOC,QAAP,MAAqB,YAArB;AACA,OAAOC,yBAAP,MAAsC,6BAAtC;AACA,SAASC,YAAT,QAA6B,iBAA7B;AAIA,OAAO,uBAAP;;AAgBA,IAAMC,cAAc,GAAG,SAAjBA,cAAiB,OAYV;AAAA,MAXTC,UAWS,QAXTA,UAWS;AAAA,MAVTC,SAUS,QAVTA,SAUS;AAAA,MATTC,yBASS,QATTA,yBASS;AAAA,MARTC,UAQS,QARTA,UAQS;AAAA,MAPTC,KAOS,QAPTA,KAOS;AAAA,MANTC,iBAMS,QANTA,iBAMS;AAAA,MALTC,mBAKS,QALTA,mBAKS;AAAA,MAJTC,iBAIS,QAJTA,iBAIS;AAAA,MAHTC,2BAGS,QAHTA,2BAGS;AAAA,MAFTC,oBAES,QAFTA,oBAES;AAAA,MADTC,IACS,QADTA,IACS;;AACT;;;;;;AAMA,MAAMC,wBAAwB,GAAG,SAA3BA,wBAA2B,CAACC,KAAD,EAA4C;AACzE,YAAQA,KAAK,CAACC,GAAd;AACI,WAAK,OAAL;AACA,WAAK,OAAL;AACIJ,QAAAA,oBAAoB;AACpB;;AACJ,cALJ,CAMI;;AANJ;AAQH,GATD;;AAWA,MAAIK,gBAAgB,GAAG,CAAvB;AACA,MAAIC,SAAS,GAAG,CAAhB;AACA,MAAIC,aAAa,GAAG,CAApB;AACAZ,EAAAA,KAAK,CAACa,OAAN,CAAc,UAAAC,IAAI,EAAI;AAClB,QAAIA,IAAI,CAACC,MAAL,KAAgBrB,YAAhB,IAAgC,CAACoB,IAAI,CAACE,QAA1C,EAAoD;AAChDL,MAAAA,SAAS,IAAIG,IAAI,CAACG,IAAlB;AACAL,MAAAA,aAAa,IAAKE,IAAI,CAACG,IAAL,GAAYH,IAAI,CAACI,QAAlB,GAA8B,KAA/C;AACH,KAHD,MAGO,IAAIJ,IAAI,CAACC,MAAL,KAAgBrB,YAApB,EAAkC;AACrCgB,MAAAA,gBAAgB,IAAI,CAApB;AACH;AACJ,GAPD;AASA,MAAMS,OAAO,GAAIP,aAAa,GAAGD,SAAjB,GAA8B,GAA9C;AACA,MAAMS,eAAe,GAAGtB,yBAAyB,IAAIY,gBAAgB,GAAG,CAAxE;AACA,MAAMW,wBAAwB,GAAGX,gBAAgB,GAAG,CAApD;AAEA,SACI;AACI,4BAAqB,gBADzB;AAEI,0BAAmB,SAFvB;AAGI,IAAA,SAAS,EAAEnB,UAAU,CAAC,kCAAD,EAAqC;AACtD,yBAAmBK,UADmC;AAEtD,wBAAkBC;AAFoC,KAArC;AAHzB,KAQI,oBAAC,yBAAD;AACI,IAAA,UAAU,EAAEE,UADhB;AAEI,IAAA,UAAU,EAAEH,UAFhB;AAGI,IAAA,eAAe,EAAEwB,eAHrB;AAII,IAAA,SAAS,EAAEvB,SAJf;AAKI,IAAA,wBAAwB,EAAEwB,wBAL9B;AAMI,IAAA,OAAO,EAAEhB,oBANb;AAOI,IAAA,SAAS,EAAEE,wBAPf;AAQI,IAAA,2BAA2B,EAAEH,2BARjC;AASI,IAAA,OAAO,EAAEe,OATb;AAUI,IAAA,IAAI,EAAEb;AAVV,IARJ,EAoBI;AAAK,IAAA,SAAS,EAAC;AAAf,KACI,oBAAC,QAAD;AACI,IAAA,yBAAyB,EAAER,yBAD/B;AAEI,IAAA,KAAK,EAAEE,KAFX;AAGI,IAAA,OAAO,EAAEC,iBAHb;AAII,IAAA,aAAa,EAAEC,mBAJnB;AAKI,IAAA,iBAAiB,EAAEC,iBALvB;AAMI,IAAA,IAAI,EAAEG;AANV,IADJ,CApBJ,CADJ;AAiCH,CA/ED;;AAiFA,eAAeX,cAAf","sourcesContent":["/**\n * @flow\n * @file Uploads manager\n */\n\nimport React from 'react';\nimport classNames from 'classnames';\nimport ItemList from './ItemList';\nimport OverallUploadsProgressBar from './OverallUploadsProgressBar';\nimport { STATUS_ERROR } from '../../constants';\nimport type { UploadItem } from '../../common/types/upload';\nimport type { View } from '../../common/types/core';\n\nimport './UploadsManager.scss';\n\ntype Props = {\n    isDragging: boolean,\n    isExpanded: boolean,\n    isResumableUploadsEnabled: boolean,\n    isVisible: boolean,\n    items: UploadItem[],\n    onItemActionClick: Function,\n    onRemoveActionClick: (item: UploadItem) => void,\n    onUpgradeCTAClick?: Function,\n    onUploadsManagerActionClick: Function,\n    toggleUploadsManager: Function,\n    view: View,\n};\n\nconst UploadsManager = ({\n    isExpanded,\n    isVisible,\n    isResumableUploadsEnabled,\n    isDragging,\n    items,\n    onItemActionClick,\n    onRemoveActionClick,\n    onUpgradeCTAClick,\n    onUploadsManagerActionClick,\n    toggleUploadsManager,\n    view,\n}: Props) => {\n    /**\n     * Keydown handler for progress bar\n     *\n     * @param {SyntheticKeyboardEvent} event\n     * @return {void}\n     */\n    const handleProgressBarKeyDown = (event: SyntheticKeyboardEvent<*>): void => {\n        switch (event.key) {\n            case 'Enter':\n            case 'Space':\n                toggleUploadsManager();\n                break;\n            default:\n            // noop\n        }\n    };\n\n    let numFailedUploads = 0;\n    let totalSize = 0;\n    let totalUploaded = 0;\n    items.forEach(item => {\n        if (item.status !== STATUS_ERROR && !item.isFolder) {\n            totalSize += item.size;\n            totalUploaded += (item.size * item.progress) / 100.0;\n        } else if (item.status === STATUS_ERROR) {\n            numFailedUploads += 1;\n        }\n    });\n\n    const percent = (totalUploaded / totalSize) * 100;\n    const isResumeVisible = isResumableUploadsEnabled && numFailedUploads > 0;\n    const hasMultipleFailedUploads = numFailedUploads > 1;\n\n    return (\n        <div\n            data-resin-component=\"uploadsmanager\"\n            data-resin-feature=\"uploads\"\n            className={classNames('be bcu-uploads-manager-container', {\n                'bcu-is-expanded': isExpanded,\n                'bcu-is-visible': isVisible,\n            })}\n        >\n            <OverallUploadsProgressBar\n                isDragging={isDragging}\n                isExpanded={isExpanded}\n                isResumeVisible={isResumeVisible}\n                isVisible={isVisible}\n                hasMultipleFailedUploads={hasMultipleFailedUploads}\n                onClick={toggleUploadsManager}\n                onKeyDown={handleProgressBarKeyDown}\n                onUploadsManagerActionClick={onUploadsManagerActionClick}\n                percent={percent}\n                view={view}\n            />\n            <div className=\"bcu-uploads-manager-item-list\">\n                <ItemList\n                    isResumableUploadsEnabled={isResumableUploadsEnabled}\n                    items={items}\n                    onClick={onItemActionClick}\n                    onRemoveClick={onRemoveActionClick}\n                    onUpgradeCTAClick={onUpgradeCTAClick}\n                    view={view}\n                />\n            </div>\n        </div>\n    );\n};\n\nexport default UploadsManager;\n"],"file":"UploadsManager.js"}