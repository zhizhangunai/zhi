/* eslint-disable no-console */
const { execSync } = require('child_process');

class RsyncPlugin {
    constructor(source, destination, message) {
        this.source = source;
        this.destination = destination;
        this.message = message;
    }

    apply(compiler) {
        compiler.hooks.done.tap('RsyncPlugin', () => {
            console.log(' '); // Output a newline
            console.log(`ðŸ”„  Pushing ${this.message}...`);
            execSync(`rsync -az --delete --exclude=".*" "${this.source}" "${this.destination}"`, { stdio: [0, 1, 2] });
            console.log(`âœ…  Push complete`);
            console.log(' '); // Output a newline
        });
    }
}
module.exports = RsyncPlugin;
